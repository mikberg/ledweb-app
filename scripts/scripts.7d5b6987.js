"use strict";angular.module("ledweb",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ledweb.main","ledweb.leds"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"scripts/main/main.html",controller:"MainCtrl",controllerAs:"main"}).otherwise({redirectTo:"/"})}]),angular.module("ledweb.main",["ledweb.leds"]),angular.module("ledweb.main").controller("MainCtrl",["Led","$location","Servers",function(a,b,c){function d(a){f.status=a}function e(a){console.error(a)}var f=this;this.led=a;var g=b.search();g.url&&(a.setUrl(g.url),c.url=g.url,c.store()),this.setRandom=function(){return a.setRandom().success(d).error(e)},this.setRGB=function(b){return a.setRGB(b).success(d).error(e)},this.refreshMode=function(){return a.getMode().success(d).error(e)},this.setSound=function(b){return a.setSound(b).success(d).error(e)},this.setOff=function(){return a.setOff().success(d).error(e)},this.refreshMode()}]),angular.module("ledweb.leds",[]),angular.module("ledweb.leds").factory("Led",["$http","Servers",function(a,b){function c(a){j.url=a}function d(b,c){return b=b?b:j.url,a.get(b,{timeout:c?c:500})}function e(b,c){return a.post(j.url,{mode:b,params:c})}function f(){return e("off",{})}function g(a){return e("rgb",a)}function h(){return e("rgb",{red:Math.random(),green:Math.random(),blue:Math.random()})}function i(a){return e("sound",a)}b.load();var j={url:b.url};return{settings:j,setUrl:c,getMode:d,setMode:e,setRGB:g,setRandom:h,setSound:i,setOff:f}}]),angular.module("ledweb.leds").factory("Servers",["$window",function(a){function b(){a.localStorage.values=angular.toJson(e)}function c(){var b=angular.fromJson(a.localStorage.values);e.url=b&&b.url?b.url:d}var d="http://localhost:5000/api",e={};return c(),angular.extend(e,{store:b,load:c})}]),angular.module("ledweb.leds").directive("serverChooser",function(){return{scope:{},templateUrl:"scripts/leds/serverchooser.directive.html",controller:["$scope","Led","Servers",function(a,b,c){a.led=b,a.url=b.settings.url,a.set=function(a){b.setUrl(a),c.url=a,c.store()}}]}}),angular.module("ledweb.leds").directive("status",["Led",function(a){return{templateUrl:"scripts/leds/status.directive.html",scope:{server:"=",validated:"="},link:function(b){function c(c){b.validated=void 0,a.getMode(c).success(function(a){b.validated=!0,b.status=a}).error(function(){console.log("error"),b.validated=!1,b.status={}})}b.$watch(function(){return b.server},function(a){a&&c(a)},!0)}}}]);